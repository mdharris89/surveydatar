% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dataprocessingfunctions.R
\name{conditionally_replace_NAs_in_multiresponse}
\alias{conditionally_replace_NAs_in_multiresponse}
\title{conditionally_replace_NAs_in_multiresponse}
\usage{
conditionally_replace_NAs_in_multiresponse(
  survey_obj = NULL,
  temp_dat = NULL,
  temp_dpdict = NULL,
  newvalue = 0,
  newlabel = "Not selected",
  variable_name_sep = "_",
  relabelpositives = TRUE,
  newpositivelabel = "Selected",
  noisy = FALSE
)
}
\arguments{
\item{survey_obj}{A survey_data object, or NULL if using temp_dat + temp_dpdict directly}

\item{temp_dat}{A data frame with labelled columns}

\item{temp_dpdict}{A dpdict with at least variable_names column}

\item{newvalue}{Value to use in place of NA (typically 0)}

\item{newlabel}{Label for the new value}

\item{variable_name_sep}{Separator used in variable names if deriving question_group}

\item{relabelpositives}{Logical. Whether to also relabel the positive values (1)}

\item{newpositivelabel}{Label to use for positive values when relabelpositives=TRUE}

\item{noisy}{Logical. If TRUE, prints progress notes}
}
\value{
Updated temp_dat with NAs replaced and labels updated, or updated survey_obj if provided
}
\description{
converts NAs to a specified code within multi-response question groups, but only where at least one option was selected
}
\details{
intended for "select-all-that-apply" questions where each option is stored as a binary variable (1=selected, NA=not answered)
after conversion, maintains metadata by properly labelling both the new value (e.g. 0="Not selected") and existing value (1="Selected")
}
\examples{
# Create test data
dat <- data.frame(
  Q1_1 = sjlabelled::set_labels(c(1, NA, NA, 1), labels = c("Yes" = 1)),
  Q1_2 = sjlabelled::set_labels(c(NA, 1, NA, NA), labels = c("Yes" = 1)),
  Q1_3 = sjlabelled::set_labels(c(NA, NA, 1, NA), labels = c("Yes" = 1)),
  Q2_1 = sjlabelled::set_labels(c(NA, NA, NA, NA), labels = c("Yes" = 1)),
  Q2_2 = sjlabelled::set_labels(c(NA, NA, NA, NA), labels = c("Yes" = 1))
)

# Create dpdict
dpdict <- data.frame(
  variable_names = c("Q1_1","Q1_2","Q1_3","Q2_1","Q2_2"),
  question_group = c("Q1","Q1","Q1","Q2","Q2"),
  stringsAsFactors = FALSE
)

# Replace NAs conditionally
out <- conditionally_replace_NAs_in_multiresponse(NULL, dat, dpdict)

# Check results
table(out$Q1_1, useNA = "ifany")
sjlabelled::get_labels(out$Q1_1)
}
