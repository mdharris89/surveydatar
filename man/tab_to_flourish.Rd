% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tabtoflourish.R
\name{tab_to_flourish}
\alias{tab_to_flourish}
\title{Convert a surveydatar tab_result into a Flourish-ready object}
\usage{
tab_to_flourish(
  tab_result,
  chart_type = NULL,
  long = TRUE,
  strip_summary_rows = TRUE,
  strip_summary_cols = TRUE,
  table_settings = NULL,
  settings = NULL,
  label_mode = "full",
  ...
)
}
\arguments{
\item{tab_result}{A tab_result produced by \code{\link{tab}}}

\item{chart_type}{Optional character; Flourish chart type. If not specified, automatically
selected based on data structure and statistic. Supported types:
\itemize{
\item \code{"table"} - Data table
\item \code{"bar_grouped"} - Grouped bar chart
\item \code{"bar_stacked"} - Stacked bar chart
\item \code{"bar_stacked_prop"} - Proportional stacked bar chart
\item \code{"column_grouped"} - Grouped column chart
\item \code{"column_stacked"} - Stacked column chart
\item \code{"column_stacked_prop"} - Proportional stacked column chart
\item \code{"line"} - Line chart
\item \code{"area"} - Area chart
\item \code{"area_stacked"} - Stacked area chart
\item \code{"donut"} - Donut/pie chart
}}

\item{long}{Should the data be pivoted to long format? (default TRUE)}

\item{strip_summary_rows}{Remove NET / Avg rows? (default TRUE for non-table charts)}

\item{strip_summary_cols}{Remove Total / NET columns? (default TRUE for non-table charts)}

\item{table_settings}{Named list of table-specific settings. See details for options.}

\item{settings}{Named list corresponding to flourish settings with dot notation e.g. "number_format.suffix" = "\%"}

\item{label_mode}{Label display mode for exported labels (default "full")}

\item{...}{Future arguments}
}
\value{
An object of class "flourish_tab" containing:
\itemize{
\item data      – a data.frame to feed into flourishcharts::bind_*()
\item bindings  – named list mapping column names to Flourish roles
\item chart_type  – character chart_type hint (may be NULL)
}
}
\description{
Convert a surveydatar tab_result into a Flourish-ready object
}
\details{
This function extracts metadata from the tab_result (statistic info, summary labels, etc.)
at the start, then transforms the data values for Flourish visualization. The transform
functions work with plain data frames and don't preserve tab_result-specific attributes
(arrays, base_matrix, etc.) since these are not needed for visualization. Base counts are
always removed as Flourish cannot handle them elegantly in visualizations (base can appear
as either a row or column depending on the statistic). If chart_type is not specified, the
function automatically selects an appropriate chart type based on the statistic type and
data dimensions. For example, count tables with many columns (>4) will use a table chart,
while simpler structures use bar or column charts. Percentage statistics may use stacked
or grouped charts depending on the number of rows and columns.

For stacked and grouped charts, the transformation depends on the statistic:
\itemize{
\item For \code{column_pct}: Data is transposed so columns become x-axis and rows become stacks/groups
\item For \code{row_pct}: Data is not transposed; rows become bars and columns become stacks/groups
}
This ensures the visualization always matches user intuition: the dimension that sums to 100\%
is shown as the primary visual element (column or bar).
\subsection{Table Settings}{

The \code{table_settings} parameter accepts a named list with the following options:

\strong{Color Coding:}
\itemize{
\item \code{color_mode} - Character: "none" (default) or "heatmap"
\item \code{color_midpoint} - Numeric value, "mean", or "median". Midpoint for diverging color scale (default "mean")
\item \code{color_palette} - Character vector of 3 colors (low, mid, high). Defaults to soft blue-white-red
}

Heatmap coloring applies a gradient to each numeric column independently,
with each column scaled from its minimum to maximum value.

\strong{Table Display:}
\itemize{
\item \code{rows_per_page} - Integer: Number of rows per page (default 20)
\item \code{show_sorting} - Logical: Enable column sorting (default TRUE)
\item \code{show_search} - Logical: Enable search/filter box (default TRUE)
\item \code{first_column_width} - Numeric: Width multiplier for first column (default 2)
}
}
}
\examples{
survey_obj <- create_survey_data(get_basic_test_dat(n = 50))
x <- tab(survey_obj, labelledcategorical, labelledordinal)
f_tab <- tab_to_flourish(x)
f_tab
# flourishcharts::flourish(f_tab$data, f_tab$chart_type, bindings = f_tab$bindings)
}
